看起来你正在尝试构建一个基于 Tauri、React 和 shadcn/ui 的桌面聊天应用，类似 QQ。这听起来是一个很棒的项目！

> 重要说明：请先删除当前模板项目中的示例/占位内容（包含示例页面、演示组件、无关路由与文案等），并严格按照本文档的结构与功能说明开展开发工作。

下面为你设计的前端页面 UI 和具体的功能设计文档：

---

### **前端页面 UI 设计**

我们将采用一个简洁、现代且功能齐全的 UI 布局，充分利用 shadcn/ui 组件库的优势。整体风格会保持一致，提供良好的用户体验。

**1. 主界面布局概览**

主界面将分为三个主要区域：

*   **左侧导航栏 (Sidebar)**：固定宽度，用于核心功能切换。
*   **中间列表区 (Chat List / Contact List)**：动态宽度，显示会话列表或联系人列表。
*   **右侧内容区 (Chat Window / Profile / Settings)**：动态宽度，显示聊天窗口、联系人资料或设置。


**2. 左侧导航栏 (Sidebar)**

*   **顶部头像/状态区**：
    *   用户头像 (Avatar)
    *   在线状态指示 (Status Indicator - 例如：在线、离开、勿扰)
    *   点击头像可打开个人资料或状态设置。
*   **核心导航图标**：
    *   **消息 (Messages)**: 默认选中，显示聊天列表。图标可以是一个对话气泡。
    *   **联系人 (Contacts)**: 显示好友列表和群组列表。图标可以是一个人头。
    *   **收藏 (Favorites)**: 显示收藏的消息、文件等。图标可以是一个星形。
    *   **文件 (Files)**: 显示传输的文件、云文件等。图标可以是一个文件夹。
    *   **应用 (Apps/Plugins)**: 如果有扩展功能或小程序。图标可以是一个网格。
    *   **通知 (Notifications)**: 显示系统通知、好友请求等。图标可以是一个铃铛，有未读数量角标。
*   **底部设置区**：
    *   **设置 (Settings)**: 打开全局设置面板。图标可以是一个齿轮。

**3. 中间列表区 (Chat List / Contact List)**

*   **顶部搜索框 (Search Bar)**：
    *   一个 `<Input />` 组件，带有占位符“搜索”。
    *   搜索功能应能实时筛选聊天记录、联系人或群组。
*   **聊天列表 (当选中“消息”时)**：
    *   每个列表项 (Chat Item) 包含：
        *   **头像 (Avatar)**: 群组头像或联系人头像。
        *   **名称 (Name)**: 群组名称或联系人昵称。
        *   **最新消息 (Latest Message)**: 预览最新一条消息的内容。
        *   **时间戳 (Timestamp)**: 最新消息的发送时间。
        *   **未读消息数 (Unread Count)**: 一个 `<Badge />` 组件显示未读数量。
        *   **静音/置顶图标 (Mute/Pin Icon)**: 如果会话被静音或置顶，显示相应图标。
    *   悬停效果和选中效果：用不同的背景色区分。
*   **联系人列表 (当选中“联系人”时)**：
    *   **分组 (Groups)**: 例如“我的好友”、“家人”、“群聊”。可以使用 `<Accordion />` 或 `<Collapsible />` 组件展开/折叠。
    *   每个联系人项 (Contact Item) 包含：
        *   **头像 (Avatar)**
        *   **昵称 (Nickname)**
        *   **在线状态 (Online Status)**: 小圆点表示。
        *   右键菜单：可进行“发送消息”、“查看资料”、“删除好友”等操作。
*   **底部操作按钮 (可选)**：
    *   例如“添加好友/群组”按钮。

**4. 右侧内容区 (Chat Window / Profile / Settings)**

**A. 聊天窗口 (当选中聊天列表项时)**

*   **顶部聊天头部 (Chat Header)**：
    *   **名称 (Name)**: 群组名称或联系人昵称。
    *   **成员数量 (Member Count)**: (仅群聊) 显示群成员数量。
    *   **操作按钮 (Action Buttons)**:
        *   视频通话/语音通话图标。
        *   查看群资料/联系人资料图标。
        *   更多选项 (例如：清空聊天记录、举报等) - 可用 `<DropdownMenu />`。
*   **消息显示区 (Message Display Area)**：
    *   使用 `<ScrollArea />` 组件，自动滚动到底部。
    *   每条消息 (Message Bubble) 包含：
        *   **发送者头像 (Sender Avatar)**
        *   **发送者名称 (Sender Name)** (仅群聊)
        *   **消息内容 (Message Content)**: 支持文本、图片、文件、表情等。
        *   **时间戳 (Timestamp)**: 可选显示。
        *   消息气泡样式：区分自己发送的消息和对方发送的消息 (背景色、对齐方式)。
    *   **时间分隔符**: 例如“---- 2023年10月26日 ----”
    *   **消息状态**: 已读/未读指示 (可选)。
*   **底部输入区 (Input Area)**：
    *   **功能按钮区 (Feature Buttons)**:
        *   表情 (Emoji) - 弹出 `<Popover />` 或自定义表情面板。
        *   图片 (Image) - 触发文件选择器。
        *   文件 (File) - 触发文件选择器。
        *   截图 (Screenshot) - 触发截图工具。
        *   语音消息 (Voice Message) - 长按录音。
    *   **文本输入框 (Text Input)**: 一个 `<Textarea />` 组件，可多行输入，支持 `@` 提及功能。
    *   **发送按钮 (Send Button)**: 一个 `<Button />` 组件，按下 Enter 可发送。

**B. 个人资料 / 群资料 (当查看联系人或群组资料时)**

*   **基本信息**: 头像、昵称、ID、个性签名、性别、地区等。
*   **操作**: 发送消息、添加好友/群组 (如果不是好友)、语音通话、视频通话等。
*   **群成员列表 (仅群聊)**: 显示所有群成员，可搜索、查看成员资料。

**C. 设置面板 (当选中“设置”时)**

*   **左侧导航 (Settings Navigation)**:
    *   账号与安全、通用设置、通知、消息管理、隐私、文件管理等。
    *   使用 `<Tabs />` 或简单的导航链接。
*   **右侧内容 (Settings Content)**:
    *   根据左侧导航项显示不同的设置表单或信息。
    *   例如：主题切换 (亮色/暗色模式)、字体大小、消息提示音、文件保存路径等。
    *   使用 shadcn/ui 的 `<Form />`, `<Switch />`, `<Slider />`, `<Select />` 等组件。

---

### **功能设计文档**

本部分将详细描述应用的关键功能，并指出在 Tauri + React + shadcn/ui 技术栈下如何实现。

**1. 用户认证与登录**

*   **UI**: 登录页面包含用户名/手机号、密码输入框，登录按钮，注册/找回密码链接。
*   **功能**:
    *   用户输入凭据后，前端通过 API 请求后端进行验证。
    *   后端返回 JWT Token 或 Session ID。
    *   前端将 Token 存储在 Tauri 的 `localstorage` 或 `store` 中，用于后续请求认证。
    *   提供“记住密码”功能 (本地加密存储)。
    *   支持扫码登录 (需要后端和移动端配合)。
*   **技术栈实现**:
    *   React `useState` 管理表单数据。
    *   `axios` 或 `fetch` 进行 API 请求。
    *   `@tauri-apps/api/store` 或 `window.localStorage` 存储认证信息。
    *    shadcn/ui 的 `<Input />`, `<Button />`。

**2. 实时通讯 (IM)**

*   **核心功能**:
    *   **消息发送与接收**: 支持文本、表情、图片、文件、语音、视频消息。
    *   **一对一聊天**: 私聊。
    *   **群组聊天**: 创建、加入、管理群组。
    *   **消息状态**: 发送中、已发送、已读、撤回、删除。
    *   **离线消息**: 用户上线后同步未读消息。
*   **技术栈实现**:
    *   **后端**: 采用 WebSocket 或 gRPC-Web 进行实时通信。
    *   **前端**:
        *   使用 `WebSocket API` 或集成 gRPC-Web 客户端库。
        *   React `Context API` 或 Redux/Zustand 管理全局消息状态和会话列表。
        *   `react-query` 或 SWR 进行数据缓存和同步。
        *   消息渲染：根据消息类型动态渲染不同组件 (例如 `ImageMessage`, `FileMessage`)。
        *   文件上传/下载: `axios` 或 `fetch` 进行文件上传到服务器，然后通过 WebSocket 通知对方文件链接。
        *    shadcn/ui 的 `<ScrollArea />`, `<Textarea />`, `<Button />`, `<Avatar />`, `<Dialog />` (用于图片预览)。

**3. 好友与群组管理**

*   **功能**:
    *   **添加/删除好友**: 发送好友请求，接受/拒绝请求。
    *   **查看好友资料**: 昵称、签名、状态等。
    *   **创建/解散群组**: 设置群名称、公告、管理员。
    *   **邀请/移除群成员**: 管理员权限。
    *   **修改群资料**: 群名称、群公告等。
    *   **群消息免打扰/置顶**: 本地配置。
*   **技术栈实现**:
    *   后端 API 提供好友和群组管理接口。
    *   前端使用 React `useState` 和 `useEffect` 管理列表数据。
    *    shadcn/ui 的 `<Dialog />` (用于添加好友/群组表单), `<DropdownMenu />` (用于操作菜单), `<Avatar />`, `<Badge />`。

**4. 消息搜索**

*   **功能**:
    *   全局搜索：搜索联系人、群组、聊天记录。
    *   会话内搜索：在当前聊天窗口中搜索历史消息。
*   **技术栈实现**:
    *   **后端**: 提供全文搜索接口 (可能需要 ES 或 Solr)。
    *   **前端**:
        *   `debounce` 或 `throttle` 函数优化搜索输入性能。
        *   React `useState` 管理搜索关键词和结果。
        *    shadcn/ui 的 `<Input />`。

**5. 文件传输**

*   **功能**:
    *   发送图片、视频、文档等文件。
    *   显示文件传输进度。
    *   文件下载与本地保存。
*   **技术栈实现**:
    *   **后端**: 文件存储服务 (例如 MinIO, OSS 或自建)。
    *   **前端**:
        *   使用 `<input type="file" />` 触发文件选择。
        *   `FormData` 对象进行文件上传到后端服务器。
        *   使用 Tauri 的 `fs` API (`@tauri-apps/api/fs`) 进行本地文件操作 (例如保存下载文件)。
        *   `@tauri-apps/api/dialog` 提示用户选择文件保存路径。
        *    shadcn/ui 的 `<Progress />` 显示上传下载进度。

**6. 系统通知**

*   **功能**:
    *   新消息通知 (桌面通知)。
    *   好友请求、群邀请通知。
    *   可在设置中自定义通知音、是否显示消息预览。
*   **技术栈实现**:
    *   **Tauri API**: `@tauri-apps/api/notification` 发送桌面通知。
    *   **WebSocket**: 后端通过 WebSocket 推送通知事件。
    *   React `useEffect` 监听通知事件并触发 Tauri 通知。

**7. 主题切换与个性化**

*   **功能**:
    *   亮色/暗色模式切换。
    *   自定义主题色 (可选)。
    *   自定义聊天背景 (可选)。
*   **技术栈实现**:
    *   shadcn/ui 内置的主题切换功能。通常通过修改 `tailwind.config.js` 并使用 CSS 变量实现。
    *   React `Context` 管理当前主题。
    *   存储用户选择的主题到 Tauri 的 `store` 或 `localstorage`。

**8. 状态管理**

*   **功能**:
    *   用户在线状态 (在线、忙碌、离开、隐身)。
    *   状态自动更新 (例如：鼠标键盘无操作一段时间后自动切换到离开)。
*   **技术栈实现**:
    *   后端需要维护用户在线状态，并通过 WebSocket 推送状态变化。
    *   前端使用 `window.onblur`/`onfocus` 或监听用户活动事件来判断用户活跃度。
    *   React `Context` 或全局状态管理库 (Zustand/Redux) 维护用户和好友的状态。

**9. 窗口操作与原生集成**

*   **功能**:
    *   最小化、最大化、关闭窗口。
    *   自定义窗口标题栏 (如果需要更原生或无边框体验)。
    *   托盘图标 (Taskbar Icon) 及托盘菜单。
    *   应用启动时自动运行 (可选)。
*   **技术栈实现**:
    *   **Tauri API**:
        *   `@tauri-apps/api/window` 控制窗口行为。
        *   `@tauri-apps/api/app` 控制应用生命周期。
        *   `@tauri-apps/api/tray` 创建和管理系统托盘。
    *   自定义标题栏：可以通过配置 `tauri.conf.json` 设置 `decorations: false`，然后自行用 React/shadcn/ui 实现最小化/最大化/关闭按钮。

---

### **技术栈选择和理由**

*   **Tauri**: 轻量级、高性能的桌面应用框架，使用 Rust 作为后端，Web 技术作为前端。相比 Electron 更小的包体积和更低的内存占用。
*   **React**: 流行的前端框架，拥有庞大的社区和丰富的组件生态，适合构建复杂的用户界面。
*   **shadcn/ui**: 基于 Radix UI 和 Tailwind CSS 构建的无头 (headless) 组件库。它提供了一套美观、可定制、无障碍的组件，可以直接复制粘贴到项目中进行修改，极大地提高了开发效率和 UI 一致性。

---

**开发建议：**

1.  **项目初始化**: 使用 `create-tauri-app` 初始化项目，选择 React 和 TypeScript 模板。
2.  **集成 shadcn/ui**: 按照 shadcn/ui 官方文档进行安装和配置，特别是 Tailwind CSS 的设置。
3.  **组件化**: 将 UI 拆分成小的、可复用的组件，例如 `ChatListItem`, `MessageBubble`, `SidebarIcon` 等。
4.  **状态管理**: 对于复杂的全局状态，考虑使用 Zustand 或 Redux Toolkit。对于组件内部或局部状态，`useState` 和 `useReducer` 足以。
5.  **API 设计**: 清晰定义前端与后端之间的 API 接口，包括 RESTful API 和 WebSocket 事件。
6.  **错误处理**: 在前端和后端都做好错误处理和用户反馈。
7.  **性能优化**: 对于长列表，考虑使用虚拟化 (Virtualization) 库如 `react-window` 或 `react-virtualized`。

希望这份详细的 UI 设计和功能文档能帮助你顺利地构建出这款类似 QQ 的聊天工具